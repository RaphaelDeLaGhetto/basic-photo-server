<% include ../_partials/head %>
  <% include ../_partials/messages %>
  <main>
    <% if (image.type === 'image') { %>
      <section class="image">
        <img src="/uploads<%= image.file %>" />
      </section>
    <% } else { %>
      <section class="link">
        <a href="/uploads<%= image.file %>"><%= image.file.split('/')[image.file.split('/').length-1] %></a>
      </section>
    <% } %>
    <% if (canWrite) { %>
      <section id="image-controls">
        <form action="<%= `/image${image.file}` %>" method="post" id="publish-image-form">
          <div class="form-group date invoice-details">
            <label for="tookPlaceAt">Date of invoice</label>  
            <input id="datepicker"
                   class="form-control"
                   type="text"
                   name="tookPlaceAt"
                   value="<%= today %>"
                   required=true>
          </div>
          <div class="form-group currency invoice-details">
            <label for="total">Total</label>  
            <input id="total" class="form-control" type="number" name="total" min="0" step="0.01" required=true>
          </div>
          <div class="form-group">
            <select class="dropdown form-control" name="category" required=true>
              <option value="">--Expense Category--</option>
              <% for (let category in categories) { %>
                <option value="<%= category %>"><%= `${category} - ${categories[category]}` %></option>
              <% } %>
            </select>
          </div>
          <div class="form-group">
            <label for="reason">Reason:</label>  
            <input class="form-control" type="text" name="reason" required=true>
          </div>
          <button id="publish-image" type="submit">Publish</button>
        </form>
        <form action="<%= `/image${image.file}?_method=DELETE` %>" method="post" id="delete-image-form">
          <button id="delete-image" type="submit">Delete</button>
        </form>
      </section>
    <% } %>
  </main> 
  <% include ../_partials/footer %>

